# Campaign Flow Builder

Визуальный конструктор цепочек маркетинговых кампаний на **React + TypeScript** с канвой **React Flow**. Позволяет собирать граф из готовых узлов, настраивать их свойства, соединять, валидировать и сохранять/экспортировать результат.

## Быстрый старт
- Установка зависимостей: `npm install`
- Дев‑сервер: `npm run dev`
- Сборка (проверяет типы): `npm run build`
- Линт: `npm run lint`
- Просмотр собранной версии: `npm run preview`

## Что внутри
- Палитра блоков (левый Sidebar) для добавления узлов: start/meta/type, аудитория и фильтры, разветвления, A/B‑тест, action, LLM‑текст.
- Канва **React Flow** (`FlowCanvas`) с кастомными карточками (`NodeRenderer`) и поддержкой соединений/перетаскивания.
- Панель свойств справа (`NodePropertiesPanel`) с формами, зависящими от типа узла, и быстрыми редакторами условий/веток/переменных.
- Toolbar: создание нового flow, сохранение/загрузка из `localStorage`, экспорт в JSON, запуск валидации с отображением ошибок.
- Хранилище и типы данных описаны в `src/utils/storage.ts` и `src/types/*`.

## Формат данных
Каждая схема — это `CampaignFlow` с полями `id`, `name`, `nodes`, `edges`, где `nodes` содержат `type`, `position` и `data` (структура зависит от типа узла, см. `src/types/nodes.ts`). Сохранение идет в `localStorage` под ключом `campaigns`, экспорт — в JSON‑файл.

## Правила валидации (коротко)
- Должен быть ровно один узел `campaignStart`.
- Узлы `campaignMeta`, `campaignType`, `filter`, `funnelSplit`, `abTest`, `action` требуют входящего ребра.
- `action` не может иметь исходящих ребер.
- `abTest` — строго два исходящих ребра.
- `funnelSplit` — минимум две ветки и исходящие ребра под каждую.
- Самопетли запрещены.

## Сборка и деплой
- Результат сборки: `dist/` (`npm run build`).
- В репозитории есть `vercel.json` для деплоя Vite‑билда на Vercel.
